{% extends "base.html" %}

{% block title %}
Список задач
{% endblock title %}

{% block content %}
<div class="container-fluid text-bg-dark p-4">
    <h1>Список задач</h1>

    <!-- Форма для фильтрации по компаниям -->
    <form method="get" class="mb-3">
        <label for="company_id" class="form-label">Фильтровать по компании:</label>
        <select name="company_id" id="company_id" class="form-select" onchange="this.form.submit()">
            <option value="">Все компании</option>
            {% for company in companies %}
                <option value="{{ company.id }}" {% if company.id|stringformat:"s" == request.GET.company_id %}selected{% endif %}>{{ company.name }}</option>
            {% endfor %}
        </select>
    </form>

    <div class="mb-3">
        {% if request.GET.company_id %}  <!-- Проверяем, выбрана ли компания -->
            <a href="{% url 'task_create' request.GET.company_id %}" class="btn btn-success">Создать задачу</a>
        {% else %}
            <a class="btn btn-success disabled" aria-disabled="true">Создать задачу</a>
        {% endif %}
        <a href="{% url 'company_list' %}" class="btn btn-secondary">Назад к списку компаний</a>
    </div>

    <table class="table table-dark table-striped">
        <thead>
            <tr>
                <th>Заголовок</th>
                <th>Описание</th>
                <th>Статус</th>
                <th>Дата создания</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks %}
            <tr>
                <td>{{ task.title }}</td>
                <td>{{ task.description }}</td>
                <td>{{ task.get_execution_status_display }}</td>
                <td>{{ task.created_at }}</td>
                <td>
                    <a href="{% url 'task_edit' request.GET.company_id task.id %}" class="btn btn-warning">Редактировать</a>
                    <form action="{% url 'task_delete' request.GET.company_id task.id %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <input type="submit" class="btn btn-danger" value="Удалить" onclick="return confirm('Вы уверены, что хотите удалить эту задачу?');">
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">Нет задач для отображения.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock content %}


{#{% extends "base.html" %}#}
{##}
{#{% block title %}#}
{#Список задач#}
{#{% endblock title %}#}
{##}
{#{% block content %}#}
{#<div class="container-fluid text-bg-dark p-4">#}
{#    <h1>Список задач</h1>#}
{##}
{#    <!-- Форма для фильтрации по компаниям -->#}
{#    <form method="get" class="mb-3">#}
{#        <label for="company_id" class="form-label">Фильтровать по компании:</label>#}
{#        <select name="company_id" id="company_id" class="form-select" onchange="this.form.submit()">#}
{#            <option value="">Все компании</option>#}
{#            {% for company in companies %}#}
{#                <option value="{{ company.id }}" {% if company.id|stringformat:"s" == request.GET.company_id %}selected{% endif %}>{{ company.name }}</option>#}
{#            {% endfor %}#}
{#        </select>#}
{#    </form>#}
{##}
{#    <div class="mb-3">#}
{#        {% if request.GET.company_id %}  <!-- Проверяем, выбрана ли компания -->#}
{#            <a href="{% url 'task_create' request.GET.company_id %}" class="btn btn-success">Создать задачу</a>#}
{#        {% else %}#}
{#            <a class="btn btn-success disabled" aria-disabled="true">Создать задачу</a>#}
{#        {% endif %}#}
{#        <a href="{% url 'company_list' %}" class="btn btn-secondary">Назад к списку компаний</a>#}
{#    </div>#}
{##}
{#    <table class="table table-dark table-striped">#}
{#        <thead>#}
{#            <tr>#}
{#                <th>Заголовок</th>#}
{#                <th>Описание</th>#}
{#                <th>Статус</th>#}
{#                <th>Дата создания</th>#}
{#                <th>Действия</th>#}
{#            </tr>#}
{#        </thead>#}
{#        <tbody>#}
{#            {% for task in tasks %}#}
{#            <tr>#}
{#                <td>{{ task.title }}</td>#}
{#                <td>{{ task.description }}</td>#}
{#                <td>{{ task.get_execution_status_display }}</td>#}
{#                <td>{{ task.created_at }}</td>#}
{#                <td>#}
{#                    <a href="{% url 'task_edit' task.id %}" class="btn btn-warning">Редактировать</a>#}
{#                    <a href="{% url 'task_delete' task.id %}" class="btn btn-danger">Удалить</a>#}
{#                </td>#}
{#            </tr>#}
{#            {% empty %}#}
{#            <tr>#}
{#                <td colspan="5" class="text-center">Нет задач для отображения.</td>#}
{#            </tr>#}
{#            {% endfor %}#}
{#        </tbody>#}
{#    </table>#}
{#</div>#}
{#{% endblock content %}#}


{##}
{#{% extends "base.html" %}#}
{##}
{#{% block title %}#}
{#Мои задачи#}
{#{% endblock title %}#}
{##}
{#{% block content %}#}
{#    <!-- Проверка авторизации -->#}
{#    <div class="auth-buttons">#}
{#        {% if user.is_authenticated %}#}
{#            <p>Добро пожаловать, {{ user.username }}!</p>#}
{#            <a href="{% url 'account_logout' %}" class="btn btn-danger">Выйти</a>#}
{#        {% else %}#}
{#            <a href="{% url 'account_login' %}" class="btn btn-primary">Войти</a>#}
{#        {% endif %}#}
{#    </div>#}
{##}
{#<h2 class="container-fluid text-bg-dark">Мои задачи</h2>#}
{#<div class="d-flex flex-wrap">#}
{#    {% for task in tasks %}#}
{#    {% if task.execution_status == 'AC' %}#}
{#    <a href="{% url 'task_detail' task.id %}" class="container card text-bg-primary mb-3"#}
{#       style="max-width: 18rem; text-decoration:none">#}
{#        <div class="card-header">{{ task.author }}</div>#}
{#        <div class="card-body">#}
{#            <p class="card-text">от {{ task.created_at }}</p>#}
{#            <h5 class="card-title">{{ task.title|truncatechars:20 }}</h5>#}
{#            <p class="card-text">{{ task.description|truncatechars:50 }}</p>#}
{#        </div>#}
{#    </a>#}
{#    {% elif task.execution_status == 'CP' %}#}
{#    <a href="{% url 'task_detail' task.id %}" class="container card text-bg-success mb-3"#}
{#       style="max-width: 18rem; text-decoration:none">#}
{#        <div class="card-header">{{ task.author }}</div>#}
{#        <div class="card-body">#}
{#            <p class="card-text">от {{ task.created_at }}</p>#}
{#            <h5 class="card-title">{{ task.title|truncatechars:20 }}</h5>#}
{#            <p class="card-text">{{ task.description|truncatechars:50 }}</p>#}
{#        </div>#}
{#    </a>#}
{#    {% elif task.execution_status == 'CN' %}#}
{#    <a href="{% url 'task_detail' task.id %}" class="container card text-bg-secondary mb-3"#}
{#       style="max-width: 18rem; text-decoration:none">#}
{#        <div class="card-header">{{ task.author }}</div>#}
{#        <div class="card-body">#}
{#            <p class="card-text">от {{ task.created_at }}</p>#}
{#            <h5 class="card-title">{{ task.title|truncatechars:20 }}</h5>#}
{#            <p class="card-text">{{ task.description|truncatechars:50 }}</p>#}
{#        </div>#}
{#    </a>#}
{#    {% elif task.execution_status == 'EX' %}#}
{#    <a href="{% url 'task_detail' task.id %}" class="container card text-bg-danger mb-3"#}
{#       style="max-width: 18rem; text-decoration:none">#}
{#        <div class="card-header">{{ task.author }}</div>#}
{#        <div class="card-body">#}
{#            <p class="card-text">от {{ task.created_at }}</p>#}
{#            <h5 class="card-title">{{ task.title|truncatechars:20 }}</h5>#}
{#            <p class="card-text">{{ task.description|truncatechars:100 }}</p>#}
{#        </div>#}
{#    </a>#}
{#    {% endif %}#}
{#    {% endfor %}#}
{#</div>#}
{#{% endblock content %}#}
