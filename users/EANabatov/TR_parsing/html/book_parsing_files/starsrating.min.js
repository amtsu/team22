$(document).ready(function () { $("#rate_this").click(function () { $("#setrating2").fadeIn(350); $(".dark-overlay").fadeIn(350) }); var n = function (n) { $(".rating-stars__star").each(function () { $(this).data("vs") <= n ? $(this).addClass("sp-red") : $(this).removeClass("sp-red") }) }; $(".rating-stars__star").hover(function () { var t = $(this).data("vs"); n(t) }); $(".rating-stars__star").click(function () { var n = $(this).data("vs"); $("#rate_this_text").html("<span>оценить на " + n + "<\/span>"); $("#user_rate").val(n); $("#rate_this_post").css("display", "") }); $("#user_rate_set_rate").click(function () { var i = $("#user_rate_form").serializeArray(), t = {}; $(i).each(function (n, i) { t[i.name] = $.trim(i.value) }); $.ajax({ type: "POST", url: $(this).data("ajaxurl"), data: t, beforeSend: function () { }, success: function (t) { console.log(t); t.total > 0 && n(t.stars); $("#user_rate_form").html("<p>Спасибо за оценку!<\/p>") }, error: function () { $("#user_rate_form").html("<p>Спасибо за оценку!<\/p>") } }) }) })